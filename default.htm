<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>B2.0 - Home</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/redmond/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script> 
<link rel="stylesheet" type="text/css" href="B/B2_0.css">
<script src="B/B2_0-Core.js"></script>
<script src="B/B2_0-Dialog.js"></script>
<script src="B/B2_0-Form.js"></script>
<script src="B/B2_0-Table.js"></script><script src="B/ExampleData.js"></script>
<script src="B/B2_0-Data.js"></script>
<script src="B/B2_0-Menu.js"></script>
<script src="B/B2_0-Tree.js"></script>
<script src="B/B2_0-Tabset.js"></script>
<script>

function init() {
	var frm = B.getForm("dlg1");
	var now = new Date();
	frm.set("month", now.getMonth()+1, "day", now.getDate());

	window.tblA = new B.ScrollingTable("tblA", 150, new B.DataColumnSet("actor,role,episodes,fy,ly,imdb"), "actor", "actors");
	tblA.footer.addButton("a", "First", function(event) { tblA.footer.disableButton("a").enableButton("b"); }).disable();
	tblA.footer.addButton("b", "Second", function(event) { tblA.footer.disableButton("b").enableButton("a"); });
	tblA.footer.addButton("c", "Rows", function(event) { mnuAdd.show(event); });
	tblA.footer.addButton("imdb", "IMDb", function(event) { doIMDB(); }, true).disable();

	tblA.onclick = function(tbl, row, cell, rn, cn, rd, changedRow) {
		if (rd.imdb.val == "") tblA.footer.buttons["imdb"].disable();
	}
	tblA.ondblclick = function(tbl, row, cell, rn, cn, rd) {
		say("You double-clicked on '" + rd.role.val + "'!!!!");
	}
	tblA.onBeforeRightClick = function(tbl, row, cell, rn, cn, rd, changedRow) {
		if (rd.imdb.val == "") {
			tblA.contextMenu.disable(0);
		} else {
			tblA.contextMenu.enable(0);
		}
	}
	tblA.onBeforeRowRender = function(rn, rd, tr, tds) {
		tds.imdb.innerHTML = B.char.CLOUD;
		if (rd.imdb.val == "") {
			tds.imdb.style.color = "silver";
		} else {
			tds.imdb.style.color = "navy";
		}
		
	}
	tblA.contextMenu.addMenu("Trivia about First Year", function() { doRestTest(3); }, "help");
	tblA.contextMenu.addMenu("Trivia about Episode count", function() { doRestTest(4); }, "help");
	tblA.contextMenu.addMenu("IMDb actor link", function() { doIMDB(); }, "newwin");

	tblA.addRows(example_data);

	window.mnuAdd = new B.ContextMenu();
	mnuAdd.addMenu("Unpick", function() { tblA.unpick(); }, "bullet");
	mnuAdd.addMenu("Reload", function() { tblA.addRows(example_data, true); }, "refresh");
	mnuAdd.addMenu("Clear", function() { tblA.clear(); }, "radio-on");

	window.tree1 = new B.Tree("tree1", null, true);
	var br = tree1.addBranch("Try dialog actions", false);
	br.addLeaf("Say something via dialog", function() { say("Ok, I said something. So there."); }, B.img("INFO"));
	br.addLeaf("Ask something", function() { ask("I'm doing great. Are you feeling well?") }, B.img("HELP"));
	br.addLeaf("Yes/No/Cancel (askC)", function() { askC("Continue to next step?"); });
	var br2 = br.addBranch("Other Form Items", false);
	br2.addLeaf("Freeze the screen", function() { 
		timedFreeze("This message will disappear using the thaw() method in 10 seconds. " +
			"Use freeze(msg) for normal stuff, but when calling remote operations that may " +
			"take some time, you may want to include a timer."); 
		window.setTimeout(function() { thaw(); }, 10000);
	});
	br2.addLeaf("Open up a form dialog", function() { doDialogTest(); });
	br.addLeaf("Choose an item with choose", 
		function() { choose("Pick one of the items", "", "Tom,Dick,Harry", 
			function(rslt) { say("You chose option " + rslt); }
		); }, B.char.CHECK);
		br.addLeaf("Get a value", function() {
		askValue("Enter a value that will be used to know how intelligent you are.", "Your Number:", "42", "Are you a Hoopy Frood?", function(rslt) {
			if (rslt != null) {
				if (rslt == "42") {
					say("Good answer, but what is the question?", "Life, Don't talk to me about life");
				} else { 
					say("Yeah, '" + rslt + "' does not make you very smart.", "IQ: < 100");
				}
			}
		})
	})
	br = tree1.addBranch("Some Other Features", false);
	br.addLeaf("Show images", function() { doImageTest(); });
	br.addLeaf("Show chars", function() { doCharTest(); });
	tree1.addLeaf("This line is just informative. You cannot click it.")
	tree1.render();

	window.ts1 = new B.TabSet("tabset1", "700px", "250px");
	ts1.addTab("a", "9em", "Tree View", "tree1");
	ts1.addTab("b", "7em", "Stupid", "testTableDiv");
	ts1.addTab("c", "6.5em", "Last Tab");
	ts1.render(0);
	ts1.tabs.b.setTitle("Table");
	
	window.smnu = new B.SlideMenu("Sample Slide Menu");
	smnu.addMenu("Toggle Section 2, item 3", function() { smnu.setSection('s2'); smnu.setDisabled(!smnu.items[4].disabled, 4);	return false; }, "FAVE");
	smnu.addMenu("Test the menu system", function() { say("Looks like it works!"); });
	sect = smnu.addSection("s2", "A Sub-Section");
	sect.addMenu("Show information...", function() { say("'Show information...'"); }, "INFO");
	sect.addMenu("Tell me a joke...", function() { say("<b>\"Why don't you ever see elephants hiding in trees?\"</b><br><br>" + B.format.RED("Because they're really good at it") + "."); }, "HAPPY");
	sect.addMenu("Create something that may take 2 or three lines in the menu...", function() { say("'Create something...'"); }, "NEW");
	sect.addMenu("Doodle...", function() { say("'Doodle...'"); }, "PENCIL");
	sect.addMenu("Check your schedule...", function() { say("'Check your schedule...'"); }, "CALENDAR");
	sect = smnu.addSection("s3", "Option Selections");
	sect.addMenu("<label><input type='checkbox' name='cbA'>Storm the castle?</label>", function() { return false; }, "");
	sect.addMenu("<label><input type='checkbox' name='cbB'>Plunder and loot?</label>", function() { return false; }, "");
	//smnu.onafterclose = function(mnu) { checkOptions(); }


}
function doIMDB() {
	var d = tblA.getDataRow();
	if (d != null) {
		if (d.imdb.val != "") {
			window.open("http://imdb.com/name/" + d.imdb.val);			
		} else {
			say("Actor '" + d.actor.val + "' does not have an IMDb page.");
		}
	}
}
function doDialogTest() {
	openDialog("dlg1");
}
function doFormDataTest() {
	var frm = B.getForm("dlg1");
	var dta = frm.get();
	dta.frz = "I just got set!";
	dta.fnam = "Daniel";
	frm.set(dta);
	frm.focus("com");
}
function doImageTest() {
	openDialog("dlgImages");
	var el = document.getElementById("dlgImageTarget");
	el.innerHTML = "";
	for (var key in B.imgdata) {
		var fn = function() { $("#dlgImageExample").html("B.img('" + this.data + "');"); };
		var img = new B.imgObject(key);
		img.style.width = "2em";
		img.onclick = fn;
		img.data = key;
		img.style.paddingRight = "1em";
		img.style.cursor = "pointer";
		el.appendChild(img)
	}
	$("#dlgImageExample").html("Click an image above to see the code here.");
}
function doCharTest() {
	openDialog("dlgImages");
	var el = document.getElementById("dlgImageTarget");
	el.style.fontSize = "14pt";
	el.innerHTML = "";
	var cnt = 0;
	for (var key in B.char) {
		var fn = function() { $("#dlgImageExample").html("B.char." + this.data + ";"); };
		var spn = document.createElement("span");
		if (cnt++ == 8) {
			spn.innerHTML = B.char[key] + "<br>";
			cnt = 0;
		} else {
			spn.innerHTML = B.char[key];			
		}
		spn.style.paddingRight = "1.5em";
		spn.onclick = fn;
		spn.data = key;
		spn.style.cursor = "pointer";
		el.appendChild(spn)
	}
	$("#dlgImageExample").html("Click a character above to see the code here.");
}
function doRestTest(typ) {
	var r = new B.RestfulService("http://numbersapi.com/");
	var frm = B.getForm("dlg1");
	var chk = frm.get();
	var test = "500"
	var fix = "";
	if (typ == 1) {
		if (!B.is.INTEGER(chk.num, 0, 999)) fix += "\nNumber must be an integer netween 0 and 999";
		if (fix.length > 0) {
			sayFix(fix);
			return;
		}
		test = chk.num + "?notfound=floor";
	}
	if (typ == 2) {
		if (!B.is.INTEGER(chk.month)) fix += "\nMonth must be an integer";
		if (fix.length > 0) {
			sayFix(fix);
			return;
		}
		test = chk.month + "/" + chk.day;
	}
	if (typ == 3) {
		var d = tblA.getDataRow();
		test = d.fy.raw + "/year";
	}
	if (typ == 4) {
		var d = tblA.getDataRow();
		test = d.episodes.raw;
	}
	
	r.getText(test, function(rslt) {
		say(rslt, "Trivia");
	});
}

</script>
</head>
<body>
	<h2 onclick='smnu.show()' style='cursor:pointer;'><img class='BIMG-MENU'> B2 Library Test Page</h2>
<div id='testTableDiv'>
<table id='tblA'>
	<tr><th data='actor,160'>Actor</th>
		<th data='role,160'>Role</th>
		<th data='episodes,50,C'>Eps</th>
		<th data='fy,65,R'>First Yr</th>
		<th data='ly,65,R'>Last Yr</th>
		<th data='imdb,100,C'>IMDb</th></tr>
</table>
</div>

<div id='tabset1'></div>


<form id='dlg1' class='BDialog' title='My First Dialog' style='height: 500px; width: 800px;'>
	<input name='sec' type='hidden' value='Secret'/>
	<table class='form'>
		<tr><td style='vertical-align: top;'>
			<table class='form'>
				<tr><th>First Name:</th><td><input class='VK' size='20' name='fnam'></td></tr>
				<tr><th>Last Name:</th><td><input class='VK' size='20' name='lnam'></td></tr>
				<tr><th>Current:</th><td><label><input type='checkbox' name='cur'> <i>Check to make current</i></label></td></tr>
				<tr><th>Address:</th><td><input class='VR' size='25' name='addr'></td></tr>
				<tr><th>City:</th><td><input size='25' name='city'></td></tr>
				<tr><th>State, Zip:</th><td><input class='VU' size='2' maxlength='2' name='st'>
					<input class='VR' size='6' maxlength='5' name='zip'></td></tr>
				<tr><th>Date:</th><td><input size='14' name='adate' class='VD'></td></tr>
				<tr><th>Number:</th><td><input name='num' size='5' maxlength='4' value='42'> <button onclick='doRestTest(1);'>get</button></td></tr>
			</table>
		</td>
		<td style='vertical-align: top;'>
			<table class='form' style='margin-left: 2em;'>
				<tr><th>Comment:</th><td><input size='25' name='com' readonly></td></tr>
				<tr><th>Option:</th><td><select class='VR' name='opt'>
					<option value=''>Select an option</option>
					<option value='1'>First</option><option value='2'>Second</option>
					<option value='3'>Third</option><option value='4'>Fourth</option>
					</select></td></tr>
				<tr><th>Multiple:</th><td><select multiple name='mult'>
					<option value='1'>First</option><option value='2'>Second</option>
					<option value='3'>Third</option><option value='4'>Fourth</option>
					<option value='5'>Fifth</option><option value='6'>Sixth</option>
					<option value='7'>Seventh</option><option value='8'>Eigth</option>
					<option value='9'>Ninth</option><option value='10'>Tenth</option>
					</select></td></tr>
				<tr><th>Radio:</th><td>
					<label><input type='radio' name='rad' value='A'>AAA</label>
					<label><input type='radio' name='rad' value='B'>BBB</label>
					<label><input type='radio' name='rad' value='C'>CCC</label>
					<label><input type='radio' name='rad' value='D'>DDD</label></td></tr>
				<tr><th>Disabled:</th><td><input size='20' maxlength='20' name='frz' disabled></td></tr>
				<tr><th>Test Date:</th><td><input name='month' size='4' maxlength='2' value='9'> / <input name='day' size='4' maxlength='2' value='1'> <button onclick='doRestTest(2);'>get</button></td></tr>
			</table>
		</td></tr>
	</table>
	<br>
	<button onclick='B.getForm("dlg1").freeze();'>Freeze</button>,
	<button onclick='B.getForm("dlg1").thaw();'>Thaw</button>,
	<button onclick='doFormDataTest()'>Data Test</button>,
	<button onclick='B.getForm("dlg1").reset();'>Reset</button>
	<button class='BDialogButton' onclick='popDialog();'>Close</button>
</form>

<div id='dlgImages' class='BDialog' style='height: 380px; width:550px;' title='Images'>
	<span id='dlgImageTarget'></span>
	<br><br><div id='dlgImageExample'></div>
	<button class='BDialogButton' onclick='popDialog();'>Close</button>
</div>
<div id='tree1' style='width:320px; padding:5px;'></div>
</body>
</html>